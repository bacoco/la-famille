# 2026-02-04 â€” Maman's Daily Log

## SÃ©curitÃ© â€” Audit & Hardening (soir)

### Contexte
- Papa demande audit sÃ©curitÃ© complet + conseil de famille
- 6 fichiers sÃ©curitÃ© trouvÃ©s dans le repo (audits Henry du 1er fÃ©v, fiches mÃ©mo, sources)

### Patches appliquÃ©s par Maman
- âœ… Gateway token renforcÃ© 64 chars (REVERT: remis ancien token car mismatch client)
- âœ… `tools.subagents.tools.deny: ["browser", "process"]`
- âœ… `discovery.mdns.mode: "off"`
- âœ… `allowInsecureAuth: false` (REVERT: remis true, Papa en a besoin pour la web UI)
- âœ… `subagents.allowAgents: ["henry", "sage", "nova", "blaise"]` ajoutÃ© Ã  main
- âœ… Nouvelle clÃ© Brave Search : `***BRAVE_KEY_REDACTED***` (ancienne leakÃ©e rÃ©voquÃ©e)
- âœ… 7 secrets GitHub rÃ©voquÃ©s par Papa (Brave, Firecrawl, INSEE, AWS, HuggingFace, Plotly, GitHub PAT)

### Conseil de famille â€” SÃ©curitÃ© (4 enfants spawnÃ©s avec succÃ¨s)
- ğŸ¦‰ Henry : score 5/10, flagge CVE-2026-25253 (WebSocket hijacking), Chromium noSandbox, secrets en clair
- ğŸ¦ Sage : downgrade CRITIQUE â†’ VIGILANCE Ã‰LEVÃ‰E, ne pas migrer sur Mac, verrouiller exec
- ğŸŒŸ Nova : deny subagent insuffisant, propose deny Ã©largi 10 outils (exec, write, edit, message, web_fetch, web_search, nodes, canvas + browser, process)
- ğŸ§® Blaise : QA gate â€” secrets pas re-testÃ©s, clÃ© Brave fonctionnait encore (rÃ©solu: nouvelle clÃ©), bot tokens Telegram = secrets sensibles en clair

### LeÃ§ons
- `sessions_spawn` avec agentId nÃ©cessite `subagents.allowAgents` sur l'agent parent
- Changer le gateway token casse l'accÃ¨s client si pas synchronisÃ© â†’ ne pas changer sans prÃ©venir Papa
- `allowInsecureAuth` nÃ©cessaire pour accÃ¨s web UI de Papa (pas de reverse proxy TLS)
- Le deny subagent Ã  2 outils est insuffisant (consensus Nova + Blaise)
- Tous les agents lisent openclaw.json (mÃªme user node) â†’ secrets pas isolÃ©s

### SynthÃ¨se du Conseil de SÃ©curitÃ©
- **Score global** : 5/10 (Henry), posture VIGILANCE Ã‰LEVÃ‰E (Sage)
- **Consensus** : patches appliquÃ©s amÃ©liorent la posture mais insuffisants seuls
- **PrioritÃ© 1** : Ã‰largir deny subagents (10 outils au lieu de 2)
- **PrioritÃ© 2** : Nettoyer historique git (secrets rÃ©voquÃ©s mais dans l'historique)
- **PrioritÃ© 3** : Monitoring automatisÃ© (cron heartbeat sÃ©curitÃ©)
- **Migration Mac** : Sage dÃ©conseille â€” trop de complexitÃ© pour le gain
- **CVE-2026-25253** : WebSocket hijacking potentiel â€” attÃ©nuÃ© par gateway token + rÃ©seau local

### âš ï¸ Incident â€” Config exposÃ©e en session
- Le contenu complet de `openclaw.json` (avec clÃ©s API, tokens bots Telegram, gateway token) a Ã©tÃ© affichÃ© dans un tool result pendant cette session
- Pas de fuite externe (session webchat locale) mais Ã  Ã©viter Ã  l'avenir
- LeÃ§on : ne jamais `cat` le fichier config entier, utiliser `jq` pour extraire les champs nÃ©cessaires

### TODO restant sÃ©curitÃ©
- Ã‰largir deny subagents (Nova recommande 10 outils) â€” en attente validation Papa
- Pre-commit gitleaks (Mac Papa)
- Nettoyer historique git repos publics (BFG)
- Activer GitHub Secret Scanning
- Monitoring sÃ©curitÃ© automatisÃ© (heartbeat)

### RÃ©cap Ã©crit
- `SECURITY-AUDIT-RECAP.md` â€” rÃ©cap complet avec tableau avant/aprÃ¨s

## Crons vÃ©rifiÃ©s
- Henry briefing IA : 6h Paris âœ…
- Henry git sync : 23h Paris âœ…  
- Codex token alert : 11 fÃ©v âœ…
