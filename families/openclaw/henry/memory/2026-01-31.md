# 2026-01-31 â€” Premier jour (complet)

## Setup initial
- Loic m'a nommÃ© **Henry** ğŸ¦‰
- Fichiers crÃ©Ã©s : IDENTITY.md, USER.md, SOUL.md, MEMORY.md, HEARTBEAT.md

## Canaux configurÃ©s
- **Telegram** âœ… â€” bot crÃ©Ã©, pairing approuvÃ© (user id: 7838297276)
- **WhatsApp Business** â€” configurÃ© cÃ´tÃ© OpenClaw mais menu "Appareils liÃ©s" absent sur iPhone Loic

## Outils & backends
- **Brave Search API** âœ… (plan Free)
- **Chrome headless** âœ… â€” fixÃ© avec wrapper script + libs extraites manuellement
- **Claude Code** v2.1.27 âœ… â€” dÃ©couverte de `CLAUDE_CODE_OAUTH_TOKEN` pour tokens OAuth
- **Codex CLI** v0.92.0 âœ… â€” auth via `codex login --device-auth` (code `QB0C-9Z1T7`)
- **Gemini CLI** v0.26.0 âœ… â€” mais quota journalier vite Ã©puisÃ©
- **Z.AI** âœ… â€” GLM-4.7 et GLM-4.5-Air comme custom provider
- 3 CLI backends enregistrÃ©s : `claude` (OAuth direct), `claude-zai` (Z.AI bridge), `codex` (device auth)

## Council multi-AI â€” Optimisations RAM (gros chantier du jour)

### ProblÃ¨me initial
- Consensus mode (3 rounds Ã— 3+ modÃ¨les) causait OOM/SIGKILL dans container 8GB
- Claude CLI peak RSS: ~260 MB, Node.js heap par dÃ©faut: 2096 MB (!!)
- Contexte inter-rounds grossissait gÃ©omÃ©triquement (raw opinions re-passÃ©es)

### Phase 1 : Optimisations RAM directes
- **Heap cap** : `NODE_OPTIONS=--max-old-space-size=384` injectÃ© dans env des subprocess CLI (initialement 192, remontÃ© Ã  384 aprÃ¨s review council)
- **Semaphore(2)** : `asyncio.Semaphore(2)` limite les CLI concurrents (COLLECT + CHALLENGE). Wrapper `_sem_call` hoistÃ© hors de la boucle while.
- **Prompts compacts** : COLLECT â‰¤500 mots, CHALLENGE top 1-3 issues, EVALUATE produit un `state_summary` â‰¤200 mots
- **Contexte Ã©valuation** : `build_context_from_evaluation()` remplace les opinions brutes au round 2+. Taille constante ~200 mots au lieu de croissance gÃ©omÃ©trique.
- **Test concluant** : 2-round consensus 4 modÃ¨les, peak 1927 MB, exit 0. Puis 3-round consensus review, peak 1834 MB, exit 0.

### Council self-review
- LancÃ© le council pour reviewer ses propres patches RAM
- Mode consensus a Ã©chouÃ© (modÃ¨les n'ont pas lu le context-file, ont passÃ© 3 rounds Ã  se critiquer)
- Mode direct a fonctionnÃ© : Claude 7/10, 5/10, 8/10, 6/10 | Codex 5/10, 7/10, 6/10, 6/10
- Corrections appliquÃ©es : heap 192â†’384 MB, wrapper semaphore hoistÃ©

### Phase 2 : InspirÃ© de Synthese-Council
- AnalysÃ© le repo `bacoco/Synthese-Council` (fork de `Alexmacapple/Synthese-Council`)
- 2Ã¨me PAT GitHub (accÃ¨s tous repos) : stockÃ© dans openclaw.json env vars
- Code : ~7000 lignes Python, pipeline fixe 3 rounds (EXTRACTIONâ†’CRITIQUEâ†’SYNTHÃˆSE), architecture modulaire

**3 amÃ©liorations portÃ©es :**
1. **Retry metrics** (`core/retry.py`) : `classify_error()` catÃ©gorise timeout/rate_limit/connection/auth, `RetryMetricsCollector` comptabilise par modÃ¨le, intÃ©grÃ© dans `query_cli_with_retry`
2. **Convergence prÃ©-filtre** (`core/convergence.py` + `council_v2.py`) : score Jaccard+overlap hybride avant EVALUATE. Seuils calibrÃ©s sur vrais outputs : >0.35 skip chairman auto-consensus, <0.05 skip auto-no-consensus. Ã‰conomise 1 CLI (~260MB+10-20s) par round.
3. **CLIExecutor Protocol** (`core/cli.py`) : Protocol injectable pour `create_process()`. DefaultCLIExecutor en prod, mocks pour tests. `query_cli()` accepte paramÃ¨tre `executor`.

## Cron jobs crÃ©Ã©s
- Briefing IA quotidien Ã  6h Paris â†’ Telegram
- Git sync quotidien Ã  23h Paris â†’ push workspace vers GitHub

## GitHub
- Repo `bacoco/Openclaw-repo` crÃ©Ã©, commits multiples poussÃ©s
- Tag `v1.0-fresh-install` sur commit `293d2e8`
- Dernier commit: `a32b025` â€” phase 2 council improvements

## PATs GitHub
- **Openclaw-repo write** : scopÃ©, stockÃ© dans openclaw.json
- **All repos read/write** : global, stockÃ© dans openclaw.json

## Fichiers modifiÃ©s dans le skill council (pas dans workspace git)
- `core/cli.py` â€” heap cap, CLIExecutor Protocol
- `core/council_v2.py` â€” semaphore, compact inter-round context, convergence pre-filter
- `core/prompts.py` â€” compact prompts, build_context_from_evaluation()
- `core/retry.py` â€” RetryMetrics, classify_error
- `core/convergence.py` â€” NOUVEAU, algorithmic convergence

## Ã€ faire demain
- [ ] Retenter WhatsApp Business
- [ ] Tester gemini dans council (quota reset)
- [ ] Finir rÃ©Ã©criture SETUP-GUIDE.md claude-only
- [ ] Configurer transcription audio
- [ ] Test council complet avec convergence prÃ©-filtre actif
- [ ] Lancer le git-sync pour capturer les fichiers du skill council
